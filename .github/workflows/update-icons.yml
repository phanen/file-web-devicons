name: Update Icons

on:
  schedule:
    - cron: "0 0 1 * *" # runs at 00:00 (UTC) on the first day of every month
  workflow_dispatch:

jobs:
  update-icons:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4
      - uses: rhysd/action-setup-vim@v1
        id: vim
        with:
          neovim: true
          version: nightly
      - uses: dtolnay/rust-toolchain@stable

      - name: Update icons
        run: |
          bash ./scripts/update-icons.sh

      - name: Create commits
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'
          git add .
          git diff-index --quiet HEAD || git commit -m 'chore(icons): auto update'

      - name: PR
        uses: peter-evans/create-pull-request@v7
        with:
          title: "chore(icons): auto updates"
          branch: "update-icons"
